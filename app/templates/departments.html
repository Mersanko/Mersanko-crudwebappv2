<!DOCTYPE html>
<html>
<head>
	<title>{{title}}</title>
	<link rel="shortcut icon" type="text/css" href="{{url_for('static',filename='msuiitlogo.png')}}"> 
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
	 <style>
    .navbar{
      background-color: #fff865;
      }
    table{
        border-collapse: collapse;
        border-spacing: 0;
        width: 100%;
        border: 1px solid #ddd;
      }


      tr{
      background-color: #fff865;
      color: #000000;
      text-align: left;
      font-size: 10px;
      
      }
      th{
        background-color: #850f13;
        color: #fff865;
        font-size: 12px;
      }
      ul{
        list-style-type: none;
        margin: 0;
        padding: 2;
        }
      li{
        display: inline;
        padding-left:5px;
        padding-right:5px;
        }

      .navbar{
         border-bottom-style: solid;
         border-bottom-color: #850f13;
      }
  </style>
</head>
<body>
<nav class="navbar">
  <div class="nav-item pull-left">
  <ul class="navtab">
      <li class="nav-item" style="font-size:20px"><a href="/" style="color:#850f13"><strong>Student List</strong></a></li>
      <li class="nav-item" style="font-size:20px"><a href="/courses" style="color:#850f13"><strong>Course List</strong></a></li>
      <li class="nav-item" style="font-size:20px"><a href="/departments" style="color:#ff5733"><strong>Department List</strong></a></li>
      <li class="nav-item" style="font-size:20px"><a href="/colleges" style="color:#850f13"><strong>College List</strong></a></li>
  </ul>
  </div>
   <form class="form-inline my-2 my-lg-0">
      <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
      <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
  </form>
</nav>
<br>
<br>
<br>

<div class="container">
<div class="float-left">
<h5>No of Departments: {{dataCounts}}</h5>
</div>
<div class="float-right">  
<button class="btn btn-success btn-xs" data-toggle="modal" data-target="#addModalDepartment">Add Department</button>
</div>
<br>
<br>
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
  {% for category,message in messages %}
  <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
    <strong>{{ message }}</strong> 
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
  </div>
  {% endfor %}
  {% endif %}
{% endwith %}

<table class="table table-stripped">
    <tr>
      <th scope="col">Department no.</th>
      <th scope="col">Department</th>
      <th scope="col">College</th>
      <th scope="col">Actions</th>

    </tr>

   {% for department in departments %}
    <tr>
      <td>{{ department.0 }}</td>
      <td>{{ department.1 }}</td>
      {% for college in colleges %}
      {% if department.2 == college.0 %}
      <td>{{ college.1 }}</td>
      {% endif %}
      {% endfor %}
      <td>
      	<a href="/updatedepartment/{{department.0}}" class="btn btn-primary btn-sm" data-toggle="modal" data-target="#updateModalDepartment{{department.0}}">Update</a><!--trigger button for update modal-->
        <a href="/deletedepartment/{{department.0}}" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete?')">Delete </a>
      </td>
    </tr>

<div id="updateModalDepartment{{department.0}}" class="modal fade" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h6 class="modal-title" style="text-align:left"><strong><i>Update Department Data with Department no.{{department.0}}</i></strong></h6>
          <button type="button" class="close pull-right" data-dismiss="modal">&times;</button>
        </div>

        <div class="modal-body">
          <form action="/updatedepartment/{{department.0}}" method="POST">
            <div class="form-group">
              <label><strong>Department Name:</strong></label>
              <input type="text" id="departmentName"  name="departmentName" class="form-control" value="{{department.1}}" autofocus required>
            </div>
           
            <div class="form-group">
              <label><strong>College:</strong></label>
              <div class="input-group mb-3" > 
                <select class="custom-select" id="college" name="college" required>
                  <option disabled="" selected="">Select a College</option>
                  {% for college in colleges %}
                  {% if college.0 == department.2 %}
                  <option value="{{college.0}}" selected>{{college.2}}</option>
                  {% else %}
                  <option value="{{college.0}}" >{{college.2}}</option>
                  {% endif %}
                  {% endfor %}
                </select>
              </div>
            </div>
            <div class="form-group">
              <br>
              <button type="submit" class="btn btn-success">Save Changes</button>
              <button type="button" class="btn btn-secondary float-right" data-dismiss="modal">Close</button>
            </div>
          </form>
        </div>
     </div>
  </div>
</div>
    {% endfor%}




<div id="addModalDepartment" class="modal fade" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title" style="text-align:left"><strong><i>Add Department Data</i></strong></h4>
          <button type="button" class="close pull-right" data-dismiss="modal">&times;</button>
        </div>

        <div class="modal-body">
          <form action="{{url_for('insertdepartment')}}" method="POST">
            <div class="form-group">
              <label><strong>Department Name:</strong></label>
              <input type="text" id="departmentName"  name="departmentName" class="form-control" placeholder="Enter Department Name" autofocus required>
            </div>
           
            <div class="form-group">
              <label><strong>College:</strong></label>
              <div class="input-group mb-3" > 
                <select class="custom-select" id="college" name="college" required>
                  <option disabled="" selected="">Select a College</option>
                  {% for college in colleges %}
                  <option value="{{college.0}}">{{college.2}}</option>
                  {% endfor %}
                </select>
              </div>
            </div>
            <div class="form-group">
              <br>
              <button type="submit" class="btn btn-success">Add Department</button>
              <button type="button" class="btn btn-secondary float-right" data-dismiss="modal">Close</button>
            </div>
          </form>
        </div>
     </div>
  </div>
</div>

</table>
</div>

</body>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
</html>